<div
  *ngIf="myInfo"
  class="h-full w-full bg-white top-0 absolute min-h-0 transition-all ease-in-out p-4 duration-500"
  [ngClass]="openStatus ? 'visible left-0' : 'w-0 invisible -left-full'"
>
  <div class="flex flex-col gap-3">
    <button
      (click)="closeMainSettings()"
      class="p-3 hover:bg-gray-100 rounded-full self-start"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="w-6 h-6"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M19.5 12h-15m0 0l6.75 6.75M4.5 12l6.75-6.75"
        />
      </svg>
    </button>
    <div class="flex flex-col gap-4 justify-center items-center">
      <div
        class="w-24 h-24 bg-gray-200 rounded-full self-center overflow-hidden"
      >
        <img class="w-full h-full object-cover" [src]="myInfo.avatar" />
      </div>
      <p class="text-2xl font-bold">{{ myInfo.displayName }}</p>
      <p class="text-xs text-gray-500">{{ myInfo._id }}</p>
    </div>
    <button
      (click)="openChangeDisplayNamePanel()"
      class="flex items-center gap-4 font-bold p-2 rounded-xl hover:bg-gray-100"
    >
      <span class="p-2 bg-gray-200 rounded-lg"
        ><svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
          class="w-6 h-6"
        >
          <path
            fill-rule="evenodd"
            d="M7.5 6a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM3.751 20.105a8.25 8.25 0 0116.498 0 .75.75 0 01-.437.695A18.683 18.683 0 0112 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 01-.437-.695z"
            clip-rule="evenodd"
          /></svg
      ></span>
      Change name
    </button>
    <button
      (click)="openChangeAvatarPanel()"
      class="flex items-center gap-4 font-bold p-2 rounded-xl hover:bg-gray-100"
    >
      <span class="p-2 bg-gray-200 rounded-lg">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
          class="w-6 h-6"
        >
          <path
            fill-rule="evenodd"
            d="M1.5 6a2.25 2.25 0 012.25-2.25h16.5A2.25 2.25 0 0122.5 6v12a2.25 2.25 0 01-2.25 2.25H3.75A2.25 2.25 0 011.5 18V6zM3 16.06V18c0 .414.336.75.75.75h16.5A.75.75 0 0021 18v-1.94l-2.69-2.689a1.5 1.5 0 00-2.12 0l-.88.879.97.97a.75.75 0 11-1.06 1.06l-5.16-5.159a1.5 1.5 0 00-2.12 0L3 16.061zm10.125-7.81a1.125 1.125 0 112.25 0 1.125 1.125 0 01-2.25 0z"
            clip-rule="evenodd"
          />
        </svg>
      </span>
      Change Avatar
    </button>
    <button
      (click)="logout()"
      class="flex items-center gap-4 font-bold p-2 rounded-xl hover:bg-gray-100"
    >
      <span class="p-2 bg-gray-200 rounded-lg">
        <svg
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          class="w-6 h-6"
        >
          <path
            d="M16.8 2H14.2C11 2 9 4 9 7.2V11.25H15.25C15.66 11.25 16 11.59 16 12C16 12.41 15.66 12.75 15.25 12.75H9V16.8C9 20 11 22 14.2 22H16.79C19.99 22 21.99 20 21.99 16.8V7.2C22 4 20 2 16.8 2Z"
            fill="currentColor"
          />
          <path
            d="M4.56141 11.2498L6.63141 9.17984C6.78141 9.02984 6.85141 8.83984 6.85141 8.64984C6.85141 8.45984 6.78141 8.25984 6.63141 8.11984C6.34141 7.82984 5.86141 7.82984 5.57141 8.11984L2.22141 11.4698C1.93141 11.7598 1.93141 12.2398 2.22141 12.5298L5.57141 15.8798C5.86141 16.1698 6.34141 16.1698 6.63141 15.8798C6.92141 15.5898 6.92141 15.1098 6.63141 14.8198L4.56141 12.7498H9.00141V11.2498H4.56141Z"
            fill="currentColor"
          />
        </svg>
      </span>
      Logout
    </button>
  </div>
</div>

<div
  *ngIf="isChangeDisplayNamePanelOpen"
  class="fixed top-0 left-0 h-screen w-screen z-40"
>
  <div
    class="w-full h-full bg-black/25 backdrop-blur flex justify-center items-center p-6"
  >
    <div class="relative bg-white rounded-lg p-6 pt-14 shadow max-w-sm w-full">
      <button
        (click)="closeChangeDisplayNamePanel()"
        class="absolute top-3 right-3 p-2 rounded-full hover:bg-gray-100"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="w-6 h-6"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>
      <div class="bg-gray-50 rounded-lg flex gap-2 p-1">
        <input
          type="text"
          class="grow bg-transparent focus:ring-transparent px-4 py-2"
          placeholder="New display name"
          [(ngModel)]="newName"
        />
        <button
          (click)="changeDisplayName()"
          class="p-2 text-gray-400 hover:text-gray-700"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-6 h-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M4.5 12.75l6 6 9-13.5"
            />
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>

<div
  *ngIf="isChangeAvatarPanelOpen"
  class="fixed top-0 left-0 h-screen w-screen z-40"
>
  <div
    class="w-full h-full bg-black/25 backdrop-blur flex justify-center items-center p-6"
  >
    <div
      class="relative bg-white rounded-lg p-6 pt-14 shadow max-w-sm w-full flex flex-col gap-4"
    >
      <button
        (click)="closeChangeAvatarPanel()"
        class="absolute top-3 right-3 p-2 rounded-full hover:bg-gray-100"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="w-6 h-6"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>
      <div
        (click)="selectFile.click()"
        class="bg-gray-100 hover:bg-gray-200 cursor-pointer rounded-full overflow-hidden w-32 h-32 self-center flex justify-center items-center"
      >
        <input
          type="file"
          accept="image/*"
          class="hidden"
          (change)="onFileUpload($event)"
          #selectFile
        />
        <img
          *ngIf="newAvatar.length; else plusIcon"
          [src]="newAvatar"
          class="w-full h-full object-cover"
        />
      </div>
      <button
      (click)="changeAvatar()"
        class="px-4 py-2 rounded-lg font-semibold text-white"
        [ngClass]="
          newAvatar.length ? 'bg-green-500 hover:bg-green-700' : 'bg-gray-200'
        "
        [disabled]="!newAvatar.length"
      >
        Change
      </button>
    </div>
  </div>
</div>

<ng-template #plusIcon>
  <svg
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 24 24"
    fill="currentColor"
    class="w-6 h-6"
  >
    <path
      fill-rule="evenodd"
      d="M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z"
      clip-rule="evenodd"
    />
  </svg>
</ng-template>
